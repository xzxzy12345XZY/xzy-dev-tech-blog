import{usePageData as I,useSiteData as $,defineClientConfig as k}from"@vuepress/client";import{useLocaleConfig as U,VPLink as D,startsWith as T,keys as K,endsWith as h,hasGlobalComponent as M}from"vuepress-shared/client";import{defineComponent as R,computed as Y,h as l}from"vue";import{useRouter as w}from"vue-router";import"./styles/auto-catalog.scss";import{useAutoCatalogIconComponent as N,injectAutoCatalogIconComponent as S}from"./index.js";var B=R({name:"AutoCatalog",props:{base:{type:String,default:""},level:{type:Number,default:3},index:Boolean,hideHeading:Boolean},setup(o){const _=N(),f=U(AUTO_CATALOG_LOCALES),b=I(),E=w(),O=$(),x=i=>i?l(_,{icon:i}):null,u=({title:i,path:r,icon:n,class:e})=>l(D,{class:e,to:r},()=>[x(n),i||r]),L=i=>{const r=i[AUTO_CATALOG_INDEX_META_KEY];return typeof r>"u"||r},G=()=>{const i=o.base||b.value.path.replace(/\/[^/]+$/,"/"),r=E.getRoutes(),n=[];return r.filter(({meta:e,path:t})=>{if(!T(t,i)||t===i)return!1;if(i==="/"){const s=K(O.value.locales).filter(a=>a!=="/");if(t==="/404.html"||s.some(a=>T(t,a)))return!1}return(h(t,".html")&&!h(t,"/index.html")||h(t,"/"))&&L(e)}).map(({path:e,meta:t})=>{const s=e.substring(i.length).split("/").length;return{title:t[AUTO_CATALOG_TITLE_META_KEY]||"",icon:t[AUTO_CATALOG_ICON_META_KEY]||null,base:e.replace(/\/[^/]+\/?$/,"/"),order:t[AUTO_CATALOG_ORDER_META_KEY]||null,level:h(e,"/")?s-1:s,path:e}}).filter(({title:e,level:t})=>e&&t<=o.level).sort(({title:e,level:t,path:s,order:a},{title:c,level:d,path:m,order:p})=>t-d||(h(s,"/index.html")?-1:h(m,"/index.html")?1:a===null?p===null?e.localeCompare(c):p:p===null?a:a>0?p>0?a-p:-1:p<0?a-p:1)).forEach(e=>{const{base:t,level:s}=e;switch(s){case 1:n.push(e);break;case 2:{const a=n.find(c=>c.path===t);a&&(a.children??=[]).push(e);break}default:{const a=n.find(c=>c.path===t.replace(/\/[^/]+\/$/,"/"));if(a){const c=a.children?.find(d=>d.path===t);c&&(c.children??=[]).push(e)}}}}),n},g=Y(()=>G());return()=>{const i=g.value.some(n=>n.children),r=g.value.map(({children:n=[],icon:e,path:t,title:s})=>{const a=u({title:s,path:t,icon:e,class:"vp-catalog-title"});return i?[l("h3",{id:s,class:["vp-catalog-child-title",{"has-children":n.length}]},[l("a",{href:`#${s}`,class:"header-anchor","aria-hidden":!0},"#"),a]),n.length?l(o.index?"ol":"ul",{class:"vp-child-catalogs"},n.map(({children:c=[],icon:d,path:m,title:p})=>l("li",{class:"vp-child-catalog"},[l("div",{class:["vp-catalog-sub-title",{"has-children":c.length}]},[l("a",{href:`#${p}`,class:"header-anchor"},"#"),l(u,{title:p,path:m,icon:d,class:"vp-catalog-title"})]),c.length?l(o.index?"ol":"div",{class:o.index?"vp-sub-catalogs":"vp-sub-catalogs-wrapper"},c.map(({icon:v,path:A,title:C})=>{const y=l(u,{title:C,path:A,icon:v,class:""});return o.index?l("li",{class:"vp-sub-catalog"},y):l(u,{title:C,path:A,icon:v,class:"vp-sub-catalog-link"})})):null]))):null]:l("div",{class:"vp-catalog-child-title"},a)});return l("div",{class:["vp-catalog-wrapper",{index:o.index}]},[o.hideHeading?null:l("h2",{class:"vp-catalog-main-title"},f.value.title),g.value.length?o.index?l("ol",{class:"vp-catalogs"},r.map(n=>l("li",{class:"vp-catalog"},n))):r:l("p",{class:"vp-empty-catalog"},f.value.empty)])}}}),H=k({enhance:({app:o})=>{S(o),M("AutoCatalog",o)||o.component("AutoCatalog",B)}});export{H as default};
//# sourceMappingURL=config.js.map
